# ユーザーストーリー

## 概要

| カテゴリ | ストーリー数 |
|---------|-------------|
| 共通（認証） | 3 |
| 一般従業員 | 6 |
| 評価パネルメンバー | 4 |
| 管理者 | 5 |
| **合計** | **18** |

### 優先度サマリー

| 優先度 | 件数 | 説明 |
|--------|------|------|
| **Must** | 10 | 必須機能（これがないとシステムが成立しない） |
| **Should** | 5 | 重要機能（あるべき機能） |
| **Could** | 3 | あれば良い機能 |
| **Won't** | 0 | 今回は対象外 |

---

## 共通ストーリー（認証）

### US-001: ユーザーログイン

**ペルソナ**: 全ユーザー
**優先度**: Must

**ストーリー**:
ユーザーとして、システムにログインするために、ユーザー名とパスワードで認証したい。

**受け入れ基準**:
- [ ] ログイン画面でユーザー名とパスワードを入力できる
- [ ] 正しい認証情報でログインするとダッシュボードに遷移する
- [ ] 誤った認証情報ではエラーメッセージが表示される
- [ ] パスワードは入力時にマスク表示される

**技術的注意点**:
- パスワードはハッシュ化して保存（bcrypt推奨）
- セッション管理にはJWTまたはセッションCookieを使用

---

### US-002: ユーザーログアウト

**ペルソナ**: 全ユーザー
**優先度**: Must

**ストーリー**:
ログイン済みユーザーとして、セキュリティのために、システムからログアウトしたい。

**受け入れ基準**:
- [ ] ヘッダーにログアウトボタンが表示される
- [ ] ログアウトするとログイン画面に遷移する
- [ ] ログアウト後は認証が必要なページにアクセスできない

**技術的注意点**:
- セッション/トークンの無効化を確実に行う

---

### US-003: ロールに応じた画面表示

**ペルソナ**: 全ユーザー
**優先度**: Must

**ストーリー**:
ログイン済みユーザーとして、自分のロールに応じた機能のみ表示されることで、混乱なく操作したい。

**受け入れ基準**:
- [ ] 一般従業員には評価機能が表示されない
- [ ] パネルメンバーには管理者機能が表示されない
- [ ] 管理者にはすべての機能が表示される

**技術的注意点**:
- フロントエンドでの表示制御とバックエンドでの権限チェックを両方実装

---

## 一般従業員ストーリー

### US-004: アイデア一覧の閲覧

**ペルソナ**: 一般従業員
**優先度**: Must

**ストーリー**:
一般従業員として、他の従業員のアイデアから刺激を受けるために、公開されているアイデア一覧を閲覧したい。

**受け入れ基準**:
- [ ] ダッシュボードまたはメニューからアイデア一覧にアクセスできる
- [ ] アイデアのタイトル、提出者、提出日が一覧で確認できる
- [ ] アイデアをクリックすると詳細画面に遷移する

**技術的注意点**:
- ページネーションまたは無限スクロールを検討

---

### US-005: 新規アイデアの提出

**ペルソナ**: 一般従業員
**優先度**: Must

**ストーリー**:
一般従業員として、業務改善のアイデアを会社に提案するために、新規アイデアを提出したい。

**受け入れ基準**:
- [ ] タイトル（必須）を入力できる
- [ ] 説明文（必須）を入力できる
- [ ] 期待される効果（必須）を入力できる
- [ ] 提出ボタンでアイデアが保存される
- [ ] 提出後、確認メッセージが表示される

**技術的注意点**:
- 入力値のバリデーション（空欄チェック、文字数制限）
- XSS対策として入力値のサニタイズ

---

### US-006: アイデアの下書き保存

**ペルソナ**: 一般従業員
**優先度**: Should

**ストーリー**:
一般従業員として、アイデアを推敲してから提出するために、下書きとして保存したい。

**受け入れ基準**:
- [ ] 下書き保存ボタンでアイデアを一時保存できる
- [ ] 下書きは他のユーザーに公開されない
- [ ] マイアイデア画面から下書きを編集・削除できる
- [ ] 下書きから正式に提出できる

**技術的注意点**:
- アイデアにステータス（draft/submitted）を持たせる

---

### US-007: アイデアへの画像添付

**ペルソナ**: 一般従業員
**優先度**: Should

**ストーリー**:
一般従業員として、アイデアを視覚的に説明するために、画像を添付したい。

**受け入れ基準**:
- [ ] アイデア入力フォームで画像をアップロードできる
- [ ] 対応形式：JPEG、PNG、GIF
- [ ] ファイルサイズ上限：5MB
- [ ] アップロード後、プレビューが表示される

**技術的注意点**:
- ファイルはローカルストレージまたはデータベースに保存
- ファイル形式とサイズのバリデーション

---

### US-008: 自分のアイデア管理

**ペルソナ**: 一般従業員
**優先度**: Must

**ストーリー**:
一般従業員として、自分の提出状況を把握するために、自分のアイデア一覧を確認したい。

**受け入れ基準**:
- [ ] マイアイデア画面で自分が提出したアイデアを一覧表示
- [ ] 各アイデアのステータス（下書き/提出済み/評価完了）が確認できる
- [ ] 下書きは編集・削除できる
- [ ] 提出済みアイデアは編集・削除できない

**技術的注意点**:
- 提出済みアイデアの編集不可はバックエンドでも制御

---

### US-009: 評価結果とフィードバックの閲覧

**ペルソナ**: 一般従業員
**優先度**: Must

**ストーリー**:
一般従業員として、自分のアイデアを改善するために、評価結果とフィードバックを確認したい。

**受け入れ基準**:
- [ ] 評価完了後、アイデア詳細画面でスコアが表示される
- [ ] 各基準（実現可能性、インパクト、革新性）のスコアが確認できる
- [ ] 最終スコア（平均）が表示される
- [ ] パネルメンバーからのフィードバックコメントが表示される

**Given-When-Then（複雑な条件）**:
```
Given: 評価が完了したアイデアがある
When: 提出者がアイデア詳細画面を開く
Then: 各基準のスコアと最終スコア、フィードバックが表示される
```

**技術的注意点**:
- 評価者名は匿名化するかどうか要検討（現要件では未定義）

---

## 評価パネルメンバーストーリー

### US-010: 評価対象アイデアの確認

**ペルソナ**: 評価パネルメンバー
**優先度**: Must

**ストーリー**:
評価パネルメンバーとして、評価作業を効率的に行うために、評価対象のアイデア一覧を確認したい。

**受け入れ基準**:
- [ ] 評価画面で未評価のアイデア一覧が表示される
- [ ] 評価済みのアイデアと未評価のアイデアが区別できる
- [ ] アイデアをクリックすると評価入力画面に遷移する

**技術的注意点**:
- 全アイデアを全パネルメンバーが評価する設計（現要件）

---

### US-011: アイデアへのスコア入力

**ペルソナ**: 評価パネルメンバー
**優先度**: Must

**ストーリー**:
評価パネルメンバーとして、アイデアを公正に評価するために、3つの基準でスコアを入力したい。

**受け入れ基準**:
- [ ] 実現可能性スコア（1〜10）を入力できる
- [ ] インパクトスコア（1〜10）を入力できる
- [ ] 革新性スコア（1〜10）を入力できる
- [ ] すべての基準を入力しないと保存できない
- [ ] 保存後、評価完了として記録される

**Given-When-Then（複雑な条件）**:
```
Given: パネルメンバーがアイデア評価画面を開いている
When: 3つの基準すべてにスコアを入力して保存する
Then: 評価が記録され、そのアイデアは評価済みとなる
```

**技術的注意点**:
- 入力値は1〜10の整数に制限
- 1人のパネルメンバーは1つのアイデアに1回のみ評価可能

---

### US-012: フィードバックコメントの入力

**ペルソナ**: 評価パネルメンバー
**優先度**: Should

**ストーリー**:
評価パネルメンバーとして、提出者の成長を支援するために、フィードバックコメントを入力したい。

**受け入れ基準**:
- [ ] 評価画面でフィードバックコメント（任意）を入力できる
- [ ] コメントはスコアと一緒に保存される
- [ ] コメントは提出者に表示される

**技術的注意点**:
- コメントは任意入力（空欄可）

---

### US-013: 自分の評価履歴の確認

**ペルソナ**: 評価パネルメンバー
**優先度**: Could

**ストーリー**:
評価パネルメンバーとして、自分の評価傾向を把握するために、評価履歴を確認したい。

**受け入れ基準**:
- [ ] 自分が評価したアイデアの一覧が表示される
- [ ] 各アイデアに付けたスコアが確認できる

**技術的注意点**:
- 他のパネルメンバーのスコアは表示しない（独立評価の原則）

---

## 管理者ストーリー

### US-014: ユーザーアカウントの作成

**ペルソナ**: 管理者
**優先度**: Must

**ストーリー**:
管理者として、新しい従業員がシステムを利用できるように、ユーザーアカウントを作成したい。

**受け入れ基準**:
- [ ] ユーザー管理画面で新規ユーザーを作成できる
- [ ] ユーザー名、パスワード、ロールを設定できる
- [ ] ロールは「従業員」「パネルメンバー」「管理者」から選択
- [ ] 同じユーザー名は登録できない

**技術的注意点**:
- 初期パスワードの安全な伝達方法を検討

---

### US-015: ユーザーアカウントの編集・削除

**ペルソナ**: 管理者
**優先度**: Should

**ストーリー**:
管理者として、ユーザー情報を最新に保つために、アカウントを編集・削除したい。

**受け入れ基準**:
- [ ] ユーザー一覧から編集画面に遷移できる
- [ ] ロールを変更できる
- [ ] パスワードをリセットできる
- [ ] ユーザーを削除できる（確認ダイアログあり）

**技術的注意点**:
- 削除時は関連データ（アイデア、評価）の扱いを検討

---

### US-016: パネルメンバーの任命

**ペルソナ**: 管理者
**優先度**: Must

**ストーリー**:
管理者として、評価プロセスを開始するために、ユーザーをパネルメンバーに任命したい。

**受け入れ基準**:
- [ ] ユーザー一覧からパネルメンバーに任命できる
- [ ] パネルメンバーを解除できる
- [ ] 現在のパネルメンバー一覧が確認できる

**技術的注意点**:
- ロール変更として実装（US-015と連携）

---

### US-017: ダッシュボードの更新

**ペルソナ**: 管理者
**優先度**: Should

**ストーリー**:
管理者として、最新の評価状況を反映するために、ダッシュボードを手動更新したい。

**受け入れ基準**:
- [ ] 管理者画面に「ダッシュボード更新」ボタンがある
- [ ] ボタンをクリックすると最終スコアが再計算される
- [ ] リーダーボードの順位が更新される
- [ ] 更新完了のメッセージが表示される

**Given-When-Then（複雑な条件）**:
```
Given: 新しい評価が追加されている
When: 管理者が「ダッシュボード更新」をクリックする
Then: 最高・最低点除外の平均スコアが計算され、ランキングが更新される
```

**技術的注意点**:
- 最高点と最低点を除外した平均を計算
- パネルメンバーが3人未満の場合の計算ロジックを検討

---

### US-018: 上位アイデアの表彰

**ペルソナ**: 管理者
**優先度**: Must

**ストーリー**:
管理者として、優れたアイデアを認識するために、上位3アイデアを表彰したい。

**受け入れ基準**:
- [ ] リーダーボードで上位3アイデアが強調表示される
- [ ] 表彰を実行すると、該当アイデアに「表彰済み」マークが付く
- [ ] 表彰されたアイデアの提出者に通知が表示される

**技術的注意点**:
- 通知はシステム内通知（ダッシュボードに表示）
- 同点の場合の順位付けルールを検討

---

## ストーリーマップ

```
+------------------+------------------+------------------+
|   一般従業員     |  パネルメンバー  |     管理者       |
+------------------+------------------+------------------+
| US-001 ログイン  | US-001 ログイン  | US-001 ログイン  |
| US-002 ログアウト| US-002 ログアウト| US-002 ログアウト|
| US-003 ロール表示| US-003 ロール表示| US-003 ロール表示|
+------------------+------------------+------------------+
| US-004 一覧閲覧  | US-010 対象確認  | US-014 ユーザー作成|
| US-005 アイデア提出| US-011 スコア入力| US-015 ユーザー編集|
| US-006 下書き保存| US-012 フィードバック| US-016 パネル任命|
| US-007 画像添付  | US-013 評価履歴  | US-017 ダッシュボード|
| US-008 マイアイデア|                 | US-018 表彰      |
| US-009 評価閲覧  |                  |                  |
+------------------+------------------+------------------+
```

---

## INVEST基準チェック

| 基準 | 説明 | 対応状況 |
|------|------|----------|
| **I**ndependent | 各ストーリーは独立して実装可能 | ✓ 依存関係を最小化 |
| **N**egotiable | 詳細は実装時に調整可能 | ✓ 受け入れ基準で柔軟性確保 |
| **V**aluable | 各ストーリーはユーザーに価値を提供 | ✓ ペルソナの目的に対応 |
| **E**stimable | 見積もり可能なサイズ | ✓ 中程度の粒度で統一 |
| **S**mall | 1スプリントで完了可能 | ✓ 画面/操作単位で分割 |
| **T**estable | テスト可能な受け入れ基準 | ✓ 具体的な基準を記載 |

---

*作成日: 2026-01-17*
*ストーリー総数: 18件*
